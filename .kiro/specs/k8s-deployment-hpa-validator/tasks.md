# 実装計画

- [x] 1. プロジェクト構造とコア インターフェースの設定
  - Goプロジェクトの基本構造を作成
  - 必要な依存関係を定義（go.mod）
  - バリデーション インターフェースとデータ構造を定義
  - _要件: 3.1, 3.2_

- [x] 2. バリデーション ロジックの実装
- [x] 2.1 Deployment バリデーション機能の実装
  - Deploymentのreplica数チェック機能を実装
  - 関連するHPAの検索機能を実装
  - Deploymentバリデーションの単体テストを作成
  - _要件: 1.1, 1.3_

- [x] 2.2 HPA バリデーション機能の実装
  - HPAの対象Deployment取得機能を実装
  - 対象DeploymentのReplica数チェック機能を実装
  - HPAバリデーションの単体テストを作成
  - _要件: 1.2, 1.3_

- [x] 2.3 エラーメッセージとレスポンス処理の実装
  - 日本語エラーメッセージの定義と実装
  - ValidationResultの構造体とレスポンス生成機能を実装
  - エラーハンドリングの単体テストを作成
  - _要件: 2.1, 2.2_

- [x] 3. Webhook サーバーの実装
- [x] 3.1 HTTPSサーバーとハンドラーの実装
  - TLS対応のHTTPサーバーを実装
  - Admission Requestの受信とパース機能を実装
  - Admission Responseの生成と送信機能を実装
  - _要件: 3.1, 3.2_

- [x] 3.2 Kubernetes クライアントの統合
  - Kubernetes APIクライアントの初期化を実装
  - クライアント設定とエラーハンドリングを実装
  - クライアント統合の単体テストを作成
  - _要件: 3.1, 4.2_

- [x] 3.3 Webhook エンドポイントの実装
  - /validate エンドポイントの実装
  - リクエストルーティングとミドルウェアを実装
  - ヘルスチェック エンドポイントを実装
  - _要件: 3.1, 3.2_

- [x] 4. TLS証明書管理の実装
- [x] 4.1 証明書生成スクリプトの作成
  - 自己署名証明書生成スクリプトを作成
  - kind環境用の証明書設定を実装
  - 証明書の検証機能を実装
  - _要件: 3.1_

- [x] 4.2 証明書ローダーの実装
  - 証明書ファイルの読み込み機能を実装
  - 証明書の検証とエラーハンドリングを実装
  - 証明書管理の単体テストを作成
  - _要件: 3.1_

- [-] 5. Kubernetes マニフェストの作成
- [x] 5.1 Deployment とService マニフェストの作成
  - Webhookサーバー用のDeploymentマニフェストを作成
  - Service マニフェストでWebhookエンドポイントを公開
  - リソース制限とヘルスチェックを設定
  - _要件: 3.1, 4.2_

- [x] 5.2 RBAC設定の作成
  - ServiceAccount、ClusterRole、ClusterRoleBindingを作成
  - 最小権限でのDeploymentとHPA読み取り権限を設定
  - RBAC設定の検証を実装
  - _要件: 4.1_

- [x] 5.3 ValidatingAdmissionWebhook設定の作成
  - ValidatingAdmissionWebhookConfigurationマニフェストを作成
  - DeploymentとHPAリソースのフィルタリング設定を実装
  - Webhook設定の検証機能を実装
  - _要件: 1.1, 1.2, 1.3_

- [x] 6. kind環境用のセットアップスクリプト
- [x] 6.1 kind クラスター作成スクリプトの実装
  - kind設定ファイルとクラスター作成スクリプトを作成
  - 必要なKubernetesバージョンとネットワーク設定を実装
  - クラスター検証機能を実装
  - _要件: 3.1, 3.2_

- [x] 6.2 デプロイメント自動化スクリプトの作成
  - Docker イメージビルドスクリプトを作成
  - kind環境へのイメージロードとデプロイスクリプトを作成
  - デプロイメント検証スクリプトを作成
  - _要件: 3.1, 3.2_

- [x] 7. 統合テストの実装
- [x] 7.1 E2Eテストケースの実装
  - 正常ケース（2+ replica + HPA）のテストを作成
  - 異常ケース（1 replica + HPA）のテストを作成
  - 同時デプロイメントシナリオのテストを作成
  - _要件: 1.1, 1.2, 1.3, 3.2_

- [x] 7.2 テスト自動化スクリプトの作成
  - テストケース実行の自動化スクリプトを作成
  - テスト結果の検証と報告機能を実装
  - テストクリーンアップ機能を実装
  - _要件: 3.2_

- [x] 8. ドキュメントとREADMEの作成
- [x] 8.1 実装手順書の作成
  - 詳細な実装手順とコマンドを文書化
  - トラブルシューティングガイドを作成
  - 設定オプションの説明を作成
  - _要件: 3.3_

- [x] 8.2 テスト手順書の作成
  - テスト実行手順の詳細な文書化
  - 各テストケースの説明と期待結果を記載
  - 検証方法とデバッグ手順を作成
  - _要件: 3.2, 3.3_