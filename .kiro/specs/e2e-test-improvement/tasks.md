# 実装計画

- [x] 1. ビルドスクリプトの改善
  - テストをスキップするオプションを追加し、イメージビルドとテスト実行を分離する
  - テスト失敗時でもビルドを続行するオプションを追加する
  - エラーメッセージとデバッグ情報を改善する
  - _要件: 1.1, 1.2, 1.3_

- [x] 1.1 build-image.sh スクリプトの修正
  - `--skip-tests` オプションを追加して、テスト実行をスキップする機能を実装
  - `--force-build` オプションを追加して、テスト失敗時でもビルドを続行する機能を実装
  - ヘルプメッセージを更新して新しいオプションを説明
  - _要件: 1.3_

- [x] 1.2 テスト実行部分の条件分岐の実装
  - オプションに基づいてテスト実行をスキップする条件分岐を追加
  - テスト失敗時の処理を改善し、強制ビルドオプションに対応
  - _要件: 1.2_

- [x] 1.3 エラーメッセージとデバッグ情報の改善
  - より詳細なエラーメッセージを表示するよう修正
  - テスト失敗時の具体的な原因と解決策を提案する機能を追加
  - _要件: 2.2_

- [x] 2. E2Eテスト実行スクリプトの改善
  - イメージ存在チェックと自動ビルド機能を追加
  - テスト環境のセットアップ状態の詳細表示を改善
  - 特定のテストカテゴリをスキップするオプションを追加
  - _要件: 1.1, 2.1, 3.2_

- [x] 2.1 run-e2e-tests.sh スクリプトの修正
  - イメージ存在チェック機能を追加
  - イメージが存在しない場合に自動ビルドを行う機能を実装
  - `--auto-build` オプションを追加して自動ビルド機能を制御
  - _要件: 1.1_

- [x] 2.2 テスト環境セットアップ状態の表示改善
  - 各ステップの進捗状況をより詳細に表示するよう修正
  - エラー発生時の具体的な原因と解決策を表示する機能を追加
  - _要件: 2.1, 2.2_

- [x] 2.3 テストカテゴリスキップ機能の実装
  - `--skip-category` オプションを追加して特定のテストカテゴリをスキップする機能を実装
  - 環境変数 `SKIP_CATEGORIES` によるテストカテゴリ制御の実装
  - _要件: 3.2_

- [x] 3. テスト環境状態チェッカーの実装
  - テスト環境の状態を確認するスクリプトを新規作成
  - 問題がある場合は具体的な解決策を提案する機能を実装
  - _要件: 2.1, 2.2, 2.3_

- [x] 3.1 check-test-environment.sh スクリプトの作成
  - テスト環境の状態（イメージの有無、クラスタの状態など）を確認する機能を実装
  - 状態情報を構造化して表示する機能を実装
  - _要件: 2.3_

- [x] 3.2 問題検出と解決策提案機能の実装
  - 一般的な問題パターンを検出する機能を実装
  - 検出した問題に対する具体的な解決策を提案する機能を実装
  - `--fix` オプションによる自動修復機能の実装
  - _要件: 2.2_

- [x] 4. Makefileの更新
  - 新しいターゲットの追加（build-image-only, build-image-force）
  - E2Eテスト実行時の自動イメージビルドオプション（e2e-full-auto）の追加
  - _要件: 1.1, 1.3, 3.1_

- [x] 4.1 イメージビルド関連ターゲットの追加
  - `build-image-only` ターゲットの追加（テストをスキップしてイメージのみビルド）
  - `build-image-force` ターゲットの追加（テスト失敗時でも強制的にイメージをビルド）
  - _要件: 1.3_

- [x] 4.2 E2Eテスト関連ターゲットの追加
  - `e2e-full-auto` ターゲットの追加（必要に応じて自動的にイメージをビルドしてE2Eテストを実行）
  - 既存のE2Eテストターゲットの説明を更新
  - _要件: 1.1_

- [x] 5. 監視テストの修正
  - test/monitoring/monitoring_test.go の修正
  - 証明書ファイルが存在しない場合のエラーハンドリングを改善
  - _要件: 1.2_

- [x] 5.1 テストスキップ条件の改善
  - 証明書ファイルが存在しない場合のスキップ処理を改善
  - テスト環境に依存しない単体テスト部分の分離
  - _要件: 1.2_

- [x] 6. ドキュメントの更新
  - README.mdの更新
  - 新しいオプションとターゲットの説明を追加
  - トラブルシューティングガイドの追加
  - _要件: 2.1, 2.2_

- [x] 6.1 README.mdの更新
  - 新しいビルドオプションとターゲットの説明を追加
  - E2Eテスト実行手順の更新
  - _要件: 2.1_

- [x] 6.2 トラブルシューティングガイドの作成
  - 一般的な問題と解決策をまとめたガイドを作成
  - エラーメッセージと対応方法の一覧を追加
  - _要件: 2.2_